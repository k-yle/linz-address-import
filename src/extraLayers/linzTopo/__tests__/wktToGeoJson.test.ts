import { wktToGeoJson } from '../wktToGeoJson';

describe('wktToGeoJson', () => {
  it('can parse Points', () => {
    expect(
      wktToGeoJson('POINT (168.37451472413 -46.1262499101384)'),
    ).toStrictEqual({
      type: 'Point',
      coordinates: [168.37451472413, -46.1262499101384],
    });
  });

  it('can parse Linestrings', () => {
    expect(
      wktToGeoJson(
        'LINESTRING (169.177030009869 -52.6024155341355,169.176335687358 -52.6025011595969,169.175711403283 -52.6024179908122)',
      ),
    ).toStrictEqual({
      type: 'LineString',
      coordinates: [
        [169.177030009869, -52.6024155341355],
        [169.176335687358, -52.6025011595969],
        [169.175711403283, -52.6024179908122],
      ],
    });
  });

  it('can parse Polygons', () => {
    expect(
      wktToGeoJson(
        'POLYGON ((175.349248175965 -36.1824229736652,175.35212691306 -36.1829710959257,175.351808520263 -36.1841715965386,175.349035400868 -36.1837272128319,175.349248175965 -36.1824229736652))',
      ),
    ).toStrictEqual({
      type: 'Polygon',
      coordinates: [
        [
          [175.349248175965, -36.1824229736652],
          [175.35212691306, -36.1829710959257],
          [175.351808520263, -36.1841715965386],
          [175.349035400868, -36.1837272128319],
          [175.349248175965, -36.1824229736652],
        ],
      ],
    });
  });

  it('can parse MultiPolygons', () => {
    expect(
      wktToGeoJson(
        'MULTIPOLYGON (((173.260217795195 -35.1205477105971,173.260221045875 -35.1205454497697)),((173.261662765546 -35.1196749748853,173.26165466687 -35.1197176351918)))',
      ),
    ).toStrictEqual({
      type: 'MultiPolygon',
      coordinates: [
        [
          [
            [173.260217795195, -35.1205477105971],
            [173.260221045875, -35.1205454497697],
          ],
        ],
        [
          [
            [173.261662765546, -35.1196749748853],
            [173.26165466687, -35.1197176351918],
          ],
        ],
      ],
    });
  });

  it("converts MultiPolygons to Polygons if they're simple", () => {
    expect(
      wktToGeoJson(
        'MULTIPOLYGON (((175.349248175965 -36.1824229736652,175.35212691306 -36.1829710959257,175.351808520263 -36.1841715965386,175.349035400868 -36.1837272128319,175.349248175965 -36.1824229736652)))',
      ),
    ).toStrictEqual({
      type: 'Polygon',
      coordinates: [
        [
          [175.349248175965, -36.1824229736652],
          [175.35212691306, -36.1829710959257],
          [175.351808520263, -36.1841715965386],
          [175.349035400868, -36.1837272128319],
          [175.349248175965, -36.1824229736652],
        ],
      ],
    });
  });
});
